 ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
 Requirement List                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
 ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
 The Signal1 and Signal2 must be inactive when the Signal3 is LOW and one o the main supply is provided. This is controlled by a 2 power-down signals generated the block Pwr.                                                                                                                                                                                                                                                                                                                                                                   
 The Signal1 and Signal2 must be inactive when the Signal3 is LOW and one o the main supply is provided.                                                                                                                                                                                                                                                                                                                                                                                                                                         
 This is controlled by a 2 power-down signals generated the block Pwr.                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
 All the logic is clocked by Osc_sgn at 30MHz with +/- 15% accuracy.                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
 The digital processed filters in the picture, applied to Vdd_sg1 and Vdd_sg2 are made in such a way that at startup, even if the signal is low, the chip_sg will be able to go high. In case of a falling edge of one of those signals a fault will be triggered and the chip_sg will go low. Note that chip_slow will filer a single clock falling edge detection pulse, thus the falling edge pulse must be extended. Thus 500us filer on chip_sg and the 50us filter on start_en must react to a falling edge even if the clock is failing.  
 The digital processed filters in the picture, applied to Vdd_sg1 and Vdd_sg2 are made in such a way that at startup, even if the signal is low, the chip_sg will be able to go high.                                                                                                                                                                                                                                                                                                                                                            
 In case of a falling edge of one of those signals a fault will be triggered and the chip_sg will go low.                                                                                                                                                                                                                                                                                                                                                                                                                                        
 Note that chip_slow will filer a single clock falling edge detection pulse, thus the falling edge pulse must be extended.                                                                                                                                                                                                                                                                                                                                                                                                                       
 The absolute accuracy of the monitor in worst case is +/-(29+25)%, calculated at the borders of PCQ clock frequency range.                                                                                                                                                                                                                                                                                                                                                                                                                      
 The monitor will detect an error only when these limits are exceeded.                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
 I_sgn delay is 265us, stopped if the comparator has switched.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
 Module1 reset and module2 resets are released 0.9ms after Vbat has crossed the undervoltage threshold as long none of the fallowing error occurs: internal Cmodule is not in regulation. Both overvoltage and undervoltage monitors must flag no fault. Sub_module1 monitor fails. Sub_module2 fails after execution.                                                                                                                                                                                                                           
 The release of the reset2 is allowed if none of the fallowing failures occurs: sub_module1 monitor fails. If the reset1 is low also the reset2 is low. Any of the module1 reset faults. If the module1 reset is low also the reset2 is low.                                                                                                                                                                                                                                                                                                     
 If any of the faults occurs the reset will be triggered and released after the normal extension time delay1 if the failure is not longer present.                                                                                                                                                                                                                                                                                                                                                                                               
 The used ALG1 algorithm is able to apply Single-Error-Detection on the addressed data-word. Any single error is flagged and corrected immediately.                                                                                                                                                                                                                                                                                                                                                                                              
 The used ALG1 algorithm is able to apply Single-Error-Detection on the addressed data-word                                                                                                                                                                                                                                                                                                                                                                                                                                                      
 In case of concurent access the priority is granted to BlockS1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
 There are two groups of clocks which need to be balanced during clock tree synthesis. One group includes clk1, clk2 and clk1_inv. The other is just the ADC clock, clk1_adc. The ADC clock has to be 5..7ns advanced to the other clock to guarantee as low noise as possible.                                                                                                                                                                                                                                                                  
 Once test mode is entered a dedicated signal in_tm is sent from pwr_module1 to module1                                                                                                                                                                                                                                                                                                                                                                                                                                                          
 After the in_tm goes active the Module1 is in test mode, and all the futher command execution can be handled as in functional mode via SPI. The in_tm sginal must not change the functionality of the system but only enables the activation of certain test modes by writing to the corresponding registers in the test mode controller.                                                                                                                                                                                                       
 The module shall become active when the following conditions are true: Vbat is supplied. VIN1 or BIN1 or BIN2 are supplied with a voltage higher than the thresholds H1 or equivalently for Vsupply + PowEn. Pin15 pin is high If any of the previous conditions is false, the SPI_in shall not receive commands.                                                                                                                                                                                                                               
 The module shall become active when the following conditions are true: Vbat is supplied.                                                                                                                                                                                                                                                                                                                                                                                                                                                        
 VIN1 or BIN1 or BIN2 are supplied with a voltage higher than the thresholds H1 or equivalently for Vsupply + PowEn.                                                                                                                                                                                                                                                                                                                                                                                                                             
 Pin15 pin is high If any of the previous conditions is false, the SPI_in shall not receive commands.                                                                                                                                                                                                                                                                                                                                                                                                                                            
 The module shall become active when the following conditions are true: Vbat_Module2 is supplied, VBIN1 is supplied Module2_reset1 and Module2_reset2 from Module1 are released, Vbat is supplied, Pin15 pin is high. If any of the previous conditions is false, the Module2_SPI_in shall not receive commands.                                                                                                                                                                                                                                 
 The chip shall be able to enter in test mode if the Pin15 pin is set to high and thereafter 3 SPI_in commands are received in the correct sequence. If the sequence is not respected, the test mode will be inhibited and locked for the rest of the ignition cycle.                                                                                                                                                                                                                                                                            
 Current references I_reference1 and I_reference2 can be muxed onto Pin25 pin                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
 Relevant signals from ROM in Module2 and Module1 shall be visible on coresponding pins                                                                                                                                                                                                                                                                                                                                                                                                                                                          
 The trimming procedure is divided in 2 phases:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
 Measure phase: the local register of the part under trimming are programmed with different values until the measured voltage/current reaches the requested value.                                                                                                                                                                                                                                                                                                                                                                               
 There are two masters which can communicate with any of the slaves. There is a single communication bus. Therefore, an arbiter is needed to suspend one of the masters in case both masters try to access the bus simultaneously.                                                                                                                                                                                                                                                                                                               
 There are two masters which can communicate with any of the slaves.                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
 There is a single communication bus.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
 Therefore, an arbiter is needed to suspend one of the masters in case both masters try to access the bus simultaneously.                                                                                                                                                                                                                                                                                                                                                                                                                        
 Maximum drop @10mA should be less than 100mV.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
 The biasing is a circuit checking if the internal generated bias currents are in the correct range. The typical threshold is at around 25% offset of the nominal current. A test mode allows lowering or raising the tested current by 100% in order to check the comparator function.                                                                                                                                                                                                                                                          
 The biasing is a circuit checking if the internal generated bias currents are in the correct range. The typical threshold is at around 25% offset of the nominal current.                                                                                                                                                                                                                                                                                                                                                                       
 A test mode allows lowering or raising the tested current by 100% in order to check the comparator function.                                                                                                                                                                                                                                                                                                                                                                                                                                    
 Therefore 20V protected input or output buffers for signals passing between the system to the safe module are used. Rising and falling times must be smaller than 20ns.                                                                                                                                                                                                                                                                                                                                                                         
 Therefore 20V protected input or output buffers for signals passing between the system to the safe module are used.                                                                                                                                                                                                                                                                                                                                                                                                                             
 Rising and falling times must be smaller than 20ns.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
 the FW is interrupted only once every 0.5ms.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
 Alpha particle protection. A SW enable to any output transistor driver must be programmed in three separate bits.                                                                                                                                                                                                                                                                                                                                                                                                                               
 During test2 and test3, the analog part of the Module2 should not toggle any signal in the digital part of the Module2. Also every output of the interface from the digital should be sampled to ease timing constraints definitions. This is not needed externally for the ADCs interface since the signals are sampled internally in the ADCs.                                                                                                                                                                                                
 During test2 and test3, the analog part of the Module2 should not toggle any signal in the digital part of the Module2.                                                                                                                                                                                                                                                                                                                                                                                                                         
 The clock tree synthesis should fulfill the requirements described in the design specification. During clock tree synthesis, an intentional delay between the ADCs clock and the other system clocks shall guarantee no noise generated by other clocks on the ADCs clock rising edge. It is allowed to have all ADCs clock edges at the same time.                                                                                                                                                                                             
 To allow the debugging of reset related issues a test structure is implemented, that allows to enable or disable each reset source for the digital system reset via SPI_Module1. Additionally the reset state for each reset source is controllable via SPI_Module1 command.                                                                                                                                                                                                                                                                    
 To allow the debugging of reset related issues a test structure is implemented, that allows to enable or disable each reset source for the digital system reset via SPI_Module1.                                                                                                                                                                                                                                                                                                                                                                
 Additionally the reset state for each reset source is controllable via SPI_Module1 command.                                                                                                                                                                                                                                                                                                                                                                                                                                                     
 In order to allow highest flexibility during debugging there is a word access functionality included, that allows to read or write every address on the internal system bus. To allow this mode without using too many SPI commands one existing SPI command is used for unlocking or locking this mode.                                                                                                                                                                                                                                        
 In order to allow highest flexibility during debugging there is a word access functionality included, that allows to read or write every address on the internal system bus.                                                                                                                                                                                                                                                                                                                                                                    
 To allow this mode without using too many SPI commands one existing SPI command is used for unlocking or locking this mode.                                                                                                                                                                                                                                                                                                                                                                                                                     
 The direct register access mode is locked for non testmode.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
 The safe transition control vector is accessable via DRA command.                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
 The controlling variable is var4 ad system address 0xabc.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
 The I_LIM flag shows the actual state of the current limitation comparator and can directly be read via direct register access.                                                                                                                                                                                                                                                                                                                                                                                                                 
 The ADC has a range between 85uA to 86.955mA.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
 Permanent Activation of Module3-Channels If it is necessary to permanently activate a Module3 channel for test purposes, the automatic channel shutdown can be bypassed by setting test2 in register4 on the register interface to 0. Dedicated SPI-commands for direct access to the register interface are available in test-mode only.                                                                                                                                                                                                       
 As a precondition to activate anyModule4-specific test-mode the main test mode has to be active.                                                                                                                                                                                                                                                                                                                                                                                                                                                
 Comparator Tests The outputs of the over-current comparator and of the over-temperature comparator are available on Module4 digital toplevel and are connected to the Module1 test-mode controller.                                                                                                                                                                                                                                                                                                                                             
 The over-temperature comparator is tested by forcing the reference of this comparator from an external pin. In the Module4 the proper testmode has to be activated and the control input has to be routed to the Module4.                                                                                                                                                                                                                                                                                                                       
 The expiration time for the watchdog is set to t_watchdog = 200us.                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
 If the expected number of parameter commands defined in the adr1.cmd1 command table is violated by less than the expected number of parameter commands, then the entire command defined by cmd1 is aborted, the non parameter command causing the abort is executed.                                                                                                                                                                                                                                                                            
 If the expected number of parameter commands defined in the adr1.cmd1 command table is violated by more than the expected number of parameter commands transferred, then the command defined by cmd1 is executed and the parameters transferred in excess will be responded with a SPI error message 0xFFEE.                                                                                                                                                                                                                                    
 If a parameter command is received without a preceeding test mode selector command, a SPI error message is returned.                                                                                                                                                                                                                                                                                                                                                                                                                            
 If the expected number of parameter commands defined in the adr1.cmd1 command table is violated by less than the expected number of parameter commands, then the entire command defined by cmd1 is aborted, the non parameter command causing the abort is executed.                                                                                                                                                                                                                                                                            
 Thus 500us filer on chip_sg and the 50us filter on start_en must react to a falling edge even if the clock is failing.                                                                                                                                                                                                                                                                                                                                                                                                                          
 The oscillator monitor is meant to verify that the PCQ and the PCD oscillator are active and working. It is not of interest to verify that the PCD oscillator is into range of accuracy, as the PCQ clock has much lower accuracy.                                                                                                                                                                                                                                                                                                              
 The relative distances between PCQ and PCD clocks is +/-29%. The absolute accuracy of the monitor in worst case is +/-29+25%, calculated at the borders of PCQ clock frequency range. The monitor will detect an error only when these limits are exceeded.                                                                                                                                                                                                                                                                                     
 The relative distances between PCQ and PCD clocks is +/-29%.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
 In test mode, upon appropiate settings, the 50ms extension time will be reduced to 350us.                                                                                                                                                                                                                                                                                                                                                                                                                                                       
 Any single error is flagged and corrected immediately.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
 There are two groups of clocks which need to be balanced during clock tree synthesis. One group includes clk1, clk2 and clk1_inv. The other is just the ADC clock, clk1_adc.                                                                                                                                                                                                                                                                                                                                                                    
 The ADC clock has to be 5..7ns advanced to the other clock to guarantee as low noise as possible.                                                                                                                                                                                                                                                                                                                                                                                                                                               
 If the REGXs are not programmed but the system is in test mode the output pin will provide the normal data as if the system is in user mode.                                                                                                                                                                                                                                                                                                                                                                                                    
 The chip shall be able to enter in test mode if the Pin15 pin is set to high and thereafter 3 SPI_in commands are received in the correct sequence. If the sequence is not respected, the test mode will be inhibited and locked for the rest of the ignition cycle. If the Pin15 pin is set to low all test modes are immediately disabled.                                                                                                                                                                                                    
 If the Pin15 pin is set to low all test modes are immediately disabled.                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
 Eeprom programming phase: after the trimming value has been found, it must be programmed into in the eeprom so that at system startup the value will be automatically used to regulate the part.                                                                                                                                                                                                                                                                                                                                                
 10% precision required for the test1 mode can be achieved using 5bit trimming.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
 Also every output of the interface from the digital should be sampled to ease timing constraints definitions. This is not needed externally for the ADCs interface since the signals are sampled internally in the ADCs.                                                                                                                                                                                                                                                                                                                        
 There are several transitions into safe mode defined. For easier testing some of these automatic transitions are disabled by the bit5. The safe transition control vector is accessable via DRA command. The controlling variable is var4 ad system address 0xabc.                                                                                                                                                                                                                                                                              
 There are several transitions into safe mode defined. For easier testing some of these automatic transitions are disabled by the bit5.                                                                                                                                                                                                                                                                                                                                                                                                          
 For production testing it is helpful to activate both safe outputs independently of the afen outputs. This is possible when the Module2_bit5 is set. The safe state is controlled by the sbit that is located in the same test register as the bit5.                                                                                                                                                                                                                                                                                            
 The detailed information about trimming a certain part is generally described in the corresponding module specifications.                                                                                                                                                                                                                                                                                                                                                                                                                       
 ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
